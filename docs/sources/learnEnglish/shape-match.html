<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Shapes</title>
<link rel="stylesheet" href="./common.css" />
<body>
<div class="game">
  <div class="board">
    <div class="prompt">
      <button class="speak" id="speak">ðŸ”Š Say shape</button>
      <div class="feedback" id="fb"></div>
    </div>
    <div class="choices" id="choices"></div>
  </div>
</div>
<script src="./_tts.js"></script>
<script src="./_audio.js"></script>
<script>
const SHAPES = [
  {name:'circle', render: ()=>{ const d=document.createElement('div'); d.style.width='90px'; d.style.height='90px'; d.style.borderRadius='50%'; d.style.background='#ffd166'; return d; }},
  {name:'square', render: ()=>{ const d=document.createElement('div'); d.style.width='90px'; d.style.height='90px'; d.style.background='#4b8bff'; return d; }},
  {name:'triangle', render: ()=>{ const d=document.createElement('div'); d.style.width='0'; d.style.height='0'; d.style.borderLeft='50px solid transparent'; d.style.borderRight='50px solid transparent'; d.style.borderBottom='90px solid #2ecc71'; return d; }}
];
let answer=null;
function pick(n, arr){ const copy=[...arr]; const out=[]; while(out.length<n && copy.length){ out.push(copy.splice(Math.random()*copy.length|0,1)[0]); } return out; }
function newRound(){ const opts=pick(3, SHAPES); answer=opts[Math.random()*opts.length|0]; render(opts); setTimeout(()=>window.LE_TTS.speak(answer.name), 200); fb(''); }
function fb(t, ok){ const el=document.getElementById('fb'); el.textContent=t; el.className='feedback ' + (ok===true? 'ok':'') + (ok===false? ' bad':''); }
function render(opts){ const wrap=document.getElementById('choices'); wrap.innerHTML=''; for(const s of opts){ const btn=document.createElement('button'); btn.className='card'; btn.setAttribute('aria-label', s.name); btn.appendChild(s.render()); btn.onclick=()=>{ const ok=s.name===answer.name; if(ok){ window.LE_AUDIO?.playDing?.(); window.LE_TTS.speak('Yes, '+s.name+'!'); } else { window.LE_AUDIO?.playBuzz?.(); window.LE_TTS.speak('Try again'); } fb(ok? 'âœ”':'âœ–', ok); if(ok) setTimeout(newRound,800); }; wrap.appendChild(btn);} }
document.getElementById('speak').onclick=()=>{ if(answer) window.LE_TTS.speak(answer.name); };
newRound();
</script>
</body>
</html>
