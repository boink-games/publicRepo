<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Numbers 1â€“3</title>
<link rel="stylesheet" href="./common.css" />
<body>
<div class="game">
  <div class="board">
    <div class="prompt">
      <button class="speak" id="speak">ðŸ”Š Say number</button>
      <div class="feedback" id="fb"></div>
    </div>
    <div class="choices" id="choices"></div>
  </div>
</div>
<script src="./_tts.js"></script>
<script src="./_audio.js"></script>
<script>
const NUMS = [1,2,3,4,5];
let answer = null;
function pickThree(){
  const a=[...NUMS]; const out=[]; while(out.length<3){ out.push(a.splice(Math.random()*a.length|0,1)[0]); }
  return out;
}
function dots(n){
  const wrap=document.createElement('div'); wrap.className='dots';
  for(let i=0;i<n;i++){ const d=document.createElement('div'); d.className='dot'; wrap.appendChild(d);} 
  return wrap;
}
function newRound(){
  const opts = pickThree();
  answer = opts[Math.random()*opts.length|0];
  const cont=document.getElementById('choices'); cont.innerHTML='';
  for(const n of opts){
    const btn=document.createElement('button'); btn.className='card';
    btn.appendChild(dots(n));
    btn.setAttribute('aria-label', String(n));
    btn.onclick=()=>{
      const ok = n===answer;
      if(ok){
        window.LE_AUDIO?.playDing?.();
        const word = (n===1? 'one' : n===2? 'two' : n===3? 'three' : n===4? 'four' : 'five');
        window.LE_TTS.speak('Yes, ' + word + '!');
      } else {
        window.LE_AUDIO?.playBuzz?.();
        window.LE_TTS.speak('Try again');
      }
      fb(ok? 'âœ”':'âœ–', ok);
      if(ok) setTimeout(newRound, 800);
    };
    cont.appendChild(btn);
  }
  setTimeout(()=>{
    const word = (answer===1? 'one' : answer===2? 'two' : answer===3? 'three' : answer===4? 'four' : 'five');
    window.LE_TTS.speak(word);
  }, 200);
  fb('');
}
function fb(t, ok){ const el=document.getElementById('fb'); el.textContent=t; el.className='feedback ' + (ok===true? 'ok':'') + (ok===false? ' bad':''); }
document.getElementById('speak').onclick=()=>{ if(answer) window.LE_TTS.speak(answer===1? 'one' : answer===2? 'two' : 'three'); };
newRound();
</script>
</body>
</html>
