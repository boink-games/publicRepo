<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Colors</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<link rel="stylesheet" href="./common.css" />
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    background-color: #f0f8ff; /* AliceBlue */
    background-image:
      radial-gradient(circle at 10% 10%, hsla(340, 80%, 88%, 0.8), transparent 25%),
      radial-gradient(circle at 80% 15%, hsla(190, 80%, 88%, 0.8), transparent 25%),
      radial-gradient(circle at 30% 80%, hsla(100, 80%, 88%, 0.8), transparent 25%),
      radial-gradient(circle at 90% 85%, hsla(40, 80%, 88%, 0.8), transparent 25%),
      radial-gradient(circle at 50% 50%, hsla(240, 80%, 88%, 0.8), transparent 25%);
    background-attachment: fixed;
  }
  h1 {
    margin: 0;
    font-size: 4em;
    padding: 16px;
    width: 100%;
    text-align: center;
    font-family: 'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', sans-serif;
    background-image: linear-gradient(to right, #d00000, #ff8c00, #ffcd3c, #90be6d, #43aa8b, #277da1);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  header {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    background: transparent;
    color: var(--text);
  }
  .right-controls {
    display: flex;
    gap: 10px;
  }
  .game {
    margin-top: 20px; /* Adjust as needed to push content down from the header */
    min-height: auto; /* Remove min-height to allow content to dictate height */
    background: transparent;
  }
  .board {
    min-width: min(92vw, 800px); /* Increased width */
    max-width: 800px; /* Added max-width */
    padding: 30px; /* Increased padding */
  }
</style>
<body>
  <h1>ðŸŽ¨ Colors ðŸŽ¨</h1>
<div class="game">
  <header>
    <button class="speak" id="speak">ðŸ”Š Say color</button>
    <div class="right-controls">
      <button class="speak" id="volume">ðŸ”Š Volume</button>
      <button class="speak" id="reset">ðŸ”„ Reset</button>
    </div>
  </header>
  <div class="board">
    <div class="feedback" id="fb"></div>
    <div class="choices" id="choices"></div>
  </div>
</div>
<script src="./_tts.js"></script>
<script src="./_audio.js"></script>
<script>
const COLORS = [
  {name:'red', css:'#ff4d4d'},
  {name:'blue', css:'#4b8bff'},
  {name:'green', css:'#2ecc71'},
  {name:'yellow', css:'#ffd166'},
  {name:'purple', css:'#a56dff'},
  {name:'orange', css:'#ff9f43'},
  {name:'pink', css:'#ff69b4'},
  {name:'cyan', css:'#00bcd4'},
  {name:'lime', css:'#cddc39'},
  {name:'brown', css:'#795548'}
];
let answer = null;
function pick(n, arr){
  const copy=[...arr];
  const out=[]; while(out.length<n && copy.length){ out.push(copy.splice(Math.random()*copy.length|0,1)[0]); }
  return out;
}
function newRound(){
  const opts = pick(6, COLORS);
  answer = opts[Math.random()*opts.length|0];
  renderChoices(opts);
  setTimeout(()=>window.LE_TTS.speak(answer.name), 200);
  fb('');
}
function fb(t, ok){
  const el = document.getElementById('fb');
  el.textContent = t;
  el.className = 'feedback ' + (ok===true? 'ok':'') + (ok===false? ' bad':'');
}
function renderChoices(opts){
  const wrap = document.getElementById('choices');
  wrap.innerHTML='';
  for(const c of opts){
    const btn = document.createElement('button');
    btn.className='card';
    btn.style.background = c.css;
    btn.setAttribute('aria-label', c.name);
    btn.onclick = ()=>{
      const correct = c.name===answer.name;
      if(correct){
        window.LE_AUDIO?.playVictory?.();
        if(window.confetti) window.confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        setTimeout(()=>window.LE_TTS.speak('Yes, '+c.name+'!'), 100);
      } else {
        window.LE_AUDIO?.playBuzz?.();
        window.LE_TTS.speak('Try again');
      }
      fb(correct? 'âœ”': 'âœ–', correct);
      if(correct) setTimeout(newRound, 900);
    };
    wrap.appendChild(btn);
  }
}
document.getElementById('speak').onclick = ()=>{ if(answer) window.LE_TTS.speak(answer.name); };
document.getElementById('volume').onclick = ()=>{ alert('Volume toggle not implemented yet!'); };
document.getElementById('reset').onclick = ()=>{ newRound(); };
newRound();
</script>
</body>
</html>
