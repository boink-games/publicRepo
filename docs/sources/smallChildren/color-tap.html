<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Match the Colors</title>
  <style>
    :root{
      --bg-top:#74c0ff;
      --bg-bottom:#b3e5ff;
      --panel:#ffffffee;
      --text:#16324f;
      --good:#00b894;
      --bad:#ff6b6b;
      --shadow: 0 8px 24px rgba(0,0,0,.18), inset 0 10px 22px rgba(255,255,255,.25);
      --ring: 0 0 0 6px rgba(255,255,255,.35), 0 10px 20px rgba(0,0,0,.25);
    }
    *{ box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height:100%; margin:0; }
    body{
      font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, var(--bg-top), var(--bg-bottom));
      overflow-x:hidden;
    }
    /* Floating clouds */
    .cloud{
      position: fixed;
      top: 5vh;
      left: -40vw;
      width: 40vw; height: 18vw; max-height: 160px;
      background:
        radial-gradient(ellipse at 20% 60%, #fff 0 55%, transparent 56%),
        radial-gradient(ellipse at 45% 45%, #fff 0 60%, transparent 61%),
        radial-gradient(ellipse at 70% 60%, #fff 0 55%, transparent 56%),
        radial-gradient(ellipse at 85% 55%, #fff 0 45%, transparent 46%);
      filter: drop-shadow(0 12px 16px rgba(0,0,0,.08));
      opacity:.7;
      border-radius: 50px;
      animation: drift 36s linear infinite;
      z-index: 0;
    }
    .cloud.c2{ top: 18vh; animation-duration: 44s; transform: scale(1.2); opacity:.6; }
    .cloud.c3{ top: 32vh; animation-duration: 52s; transform: scale(0.9); opacity:.55; }

    @keyframes drift { from{ transform: translateX(0) scale(var(--s,1)); left:-45vw; } to{ transform: translateX(150vw) scale(var(--s,1)); left: -45vw; } }

    .wrap{
      min-height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      gap:18px;
      padding: clamp(12px, 4vw, 28px);
      position: relative;
      z-index: 1;
    }

    .panel{
      width: 100%;
      max-width: 720px;
      background: var(--panel);
      border-radius: 22px;
      box-shadow: 0 14px 32px rgba(0,0,0,.15);
      padding: clamp(12px, 4vw, 28px);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: clamp(12px, 2.8vw, 22px);
      backdrop-filter: blur(4px);
    }

    .topbar{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    h1{
      margin:0;
      font-weight:900;
      letter-spacing:.5px;
      font-size: clamp(20px, 6vw, 32px);
      color: #144b8a;
      display:flex; align-items:center; gap:8px;
    }
    .badge{
      background: #ffdd57;
      color:#7a5200;
      font-weight:800;
      font-size:.75em;
      padding:.2em .6em;
      border-radius:999px;
    }

    .controls{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .iconbtn{
      border:none; background:#ffffff; color:#144b8a;
      width:44px; height:44px; border-radius:14px;
      display:grid; place-items:center; box-shadow: 0 6px 14px rgba(0,0,0,.15);
      cursor:pointer; touch-action:manipulation;
    }
    .iconbtn:active{ transform: scale(.96); }
    .icon{
      width:24px; height:24px; fill: currentColor;
    }

    .prompt{
      width:100%;
      display:flex; align-items:center; justify-content:center; gap:10px;
      font-size: clamp(18px, 5.4vw, 26px);
      font-weight:800;
      text-align:center;
      color:#0f3057;
    }
    .prompt .word{
      background:#eaf4ff;
      padding:.2em .6em;
      border-radius:12px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,.05);
      letter-spacing:1px;
    }
    .speakbtn{
      border:none; background:#e8f7ff; color:#0d6efd;
      padding:10px 14px; border-radius:999px; font-weight:800;
      display:flex; align-items:center; gap:8px; cursor:pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,.1);
      touch-action:manipulation;
    }
    .speakbtn:active{ transform: scale(.98); }

    .options{
      width:100%;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: clamp(14px, 4vw, 22px);
      align-items:center;
      justify-items:center;
    }
    @media (max-width: 520px){
      .options{ grid-template-columns: repeat(3, 1fr); }
    }

    .balloon{
      position: relative;
      width: min(28vw, 120px);
      height: min(28vw, 120px);
      min-width: 86px; min-height: 86px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      cursor: pointer;
      outline: none;
      transition: transform .12s ease, filter .2s ease;
      animation: float 4.2s ease-in-out infinite;
      will-change: transform;
      display: grid; place-items:center;
    }
    @media (prefers-reduced-motion: reduce){
      .balloon{ animation: none; }
    }
    .balloon:after{
      content:"";
      position:absolute;
      bottom:-10px; left:50%; transform: translateX(-50%);
      border-left:7px solid transparent;
      border-right:7px solid transparent;
      border-top:10px solid rgba(0,0,0,.15);
      filter: blur(.2px);
      opacity:.55;
    }
    .balloon .shine{
      position:absolute;
      top:10%; left:18%;
      width: 22%; height:22%;
      background: radial-gradient(ellipse at center, rgba(255,255,255,.95), rgba(255,255,255,.2) 65%, transparent 66%);
      border-radius:50%;
      filter: blur(.4px);
    }
    .balloon:focus-visible{ box-shadow: var(--ring); }
    .balloon:active{ transform: scale(.96); }

    @keyframes float{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-8px); }
    }
    .wrong{ animation: shake .35s ease; }
    @keyframes shake{
      10%, 90% { transform: translateX(-2px); }
      20%, 80% { transform: translateX(4px); }
      30%, 50%, 70% { transform: translateX(-6px); }
      40%, 60% { transform: translateX(6px); }
    }
    .pop{
      animation: pop .38s ease-out;
    }
    @keyframes pop{
      0%{ transform: scale(1); }
      40%{ transform: scale(1.12); }
      100%{ transform: scale(1); }
    }

    /* burst particles around correct balloon */
    .burst{
      position:absolute; inset:0; pointer-events:none;
    }
    .burst i{
      --a: 0deg;
      position:absolute;
      top:50%; left:50%;
      width:10px; height:10px; border-radius:50%;
      background: #fff;
      transform: translate(-50%, -50%) rotate(var(--a)) translateY(0);
      opacity:1;
      animation: burst 500ms ease-out forwards;
    }
    @keyframes burst{
      to{ transform: translate(-50%, -50%) rotate(var(--a)) translateY(-64px); opacity:0; }
    }

    .bar{
      width:100%;
      max-width:520px;
      height:14px;
      background: #e6f2ff;
      border-radius:999px;
      overflow:hidden;
      box-shadow: inset 0 2px 6px rgba(0,0,0,.08);
    }
    .fill{
      height:100%; width:0%;
      background: linear-gradient(90deg, #ff9ff3, #feca57, #1dd1a1, #54a0ff, #5f27cd);
      background-size: 200% 100%;
      animation: shimmer 3s linear infinite;
      transition: width .25s ease;
    }
    @keyframes shimmer{ from{ background-position:0 0; } to{ background-position:200% 0; } }

    .status{
      height: 32px;
      min-width: 180px;
      text-align:center;
      font-weight:900;
      letter-spacing:.4px;
      font-size: clamp(16px, 4.8vw, 20px);
    }

    .overlay{
      position: fixed; inset: 0;
      display:none; align-items:center; justify-content:center;
      background: rgba(0,0,0,.25);
      z-index: 10;
      backdrop-filter: blur(2px);
    }
    .countbubble{
      width:120px; height:120px;
      background:#fff;
      color:#144b8a;
      border-radius:50%;
      display:grid; place-items:center;
      font-weight:900; font-size: 58px;
      box-shadow: 0 18px 36px rgba(0,0,0,.25), inset 0 -10px 22px rgba(0,0,0,.06);
      animation: pop .4s ease;
    }

    .footer{
      font-size: 12px; opacity:.7; text-align:center;
    }
  </style>
</head>
<body>
  <div class="cloud c1" style="--s:1;"></div>
  <div class="cloud c2" style="--s:1.2;"></div>
  <div class="cloud c3" style="--s:.9;"></div>

  <div class="wrap">
    <div class="panel">
      <div class="topbar">
        <h1>
          🎈 Match the Colors
          <span class="badge">Kids</span>
        </h1>
        <div class="controls">
          <button class="iconbtn" id="soundBtn" aria-pressed="true" aria-label="Sound on">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 10v4a1 1 0 0 0 1 1h3l3.6 3.2A1 1 0 0 0 12 17v-10a1 1 0 0 0-1.4-.9L7 9H4a1 1 0 0 0-1 1z"></path><path d="M16.5 8.1a5 5 0 0 1 0 7.8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><path d="M19.5 5.5a9 9 0 0 1 0 13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg>
          </button>
          <button class="iconbtn" id="resetBtn" aria-label="Start over">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5V2L7 6l5 4V7c3.3 0 6 2.7 6 6a6 6 0 1 1-10.2-4.2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>

      <div class="prompt">
        Find the color
        <span class="word" id="word">RED</span>
        <button class="speakbtn" id="sayBtn" aria-label="Say the color">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 10v4a1 1 0 0 0 1 1h3l3.6 3.2A1 1 0 0 0 12 17v-10a1 1 0 0 0-1.4-.9L7 9H4a1 1 0 0 0-1 1z"></path></svg>
          Say it
        </button>
      </div>

      <div class="options" id="options" role="group" aria-label="Color options"></div>

      <div class="bar"><div class="fill" id="fill"></div></div>
      <div class="status" id="status"></div>
      <div class="footer">Tap a balloon to match the color. Big and friendly for little hands!</div>
    </div>
  </div>

  <div class="overlay" id="overlay" aria-hidden="true"><div class="countbubble" id="num">3</div></div>

  <script>
    // Settings
    const SETTINGS = {
      sound: true,
      speechRate: 0.9,
      speechPitch: 1.0,
      lang: 'en-US'
    };

    // Basic TTS helpers
    function speak(text){
      try {
        if (!SETTINGS.sound) return;
        if (!('speechSynthesis' in window)) return;
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(String(text));
        u.lang = SETTINGS.lang;
        u.rate = SETTINGS.speechRate; u.pitch = SETTINGS.speechPitch; u.volume = 1.0;
        window.speechSynthesis.speak(u);
      } catch(_){}
    }

    // Simple WebAudio tones
    let audioCtx = null;
    function ensureAudio(){
      if(!SETTINGS.sound) return;
      try{
        if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if(audioCtx.state === 'suspended') audioCtx.resume();
      }catch(_){}
    }
    function tone(freq=440, dur=180, type='sine', gain=0.06){
      if(!SETTINGS.sound) return;
      ensureAudio();
      if(!audioCtx) return;
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = type;
      o.frequency.value = freq;
      o.connect(g); g.connect(audioCtx.destination);
      g.gain.value = gain;
      o.start();
      g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur/1000);
      o.stop(audioCtx.currentTime + dur/1000 + 0.02);
    }
    function successSound(){
      [523.25, 659.25, 783.99].forEach((f,i)=> setTimeout(()=> tone(f, 120, 'triangle', 0.07), i*90));
    }
    function errorSound(){
      tone(220, 260, 'sawtooth', 0.05);
    }

    // Colors
    const COLORS = [
      {name:'RED', val:'#ff4d4f'},
      {name:'ORANGE', val:'#f97316'},
      {name:'YELLOW', val:'#ffd93d'},
      {name:'LIME', val:'#84cc16'},
      {name:'GREEN', val:'#2ecc71'},
      {name:'TEAL', val:'#14b8a6'},
      {name:'CYAN', val:'#06b6d4'},
      {name:'BLUE', val:'#3498db'},
      {name:'INDIGO', val:'#6366f1'},
      {name:'VIOLET', val:'#8b5cf6'},
      {name:'PURPLE', val:'#9b59b6'},
      {name:'PINK', val:'#ec4899'},
      {name:'MAGENTA', val:'#ff00ff'},
      {name:'BROWN', val:'#8b5a2b'},
      {name:'MAROON', val:'#800000'},
      {name:'NAVY', val:'#001f3f'},
      {name:'OLIVE', val:'#3d9970'},
      {name:'TURQUOISE', val:'#40e0d0'},
      {name:'GOLD', val:'#ffd700'},
      {name:'SILVER', val:'#c0c0c0'},
      {name:'BEIGE', val:'#f5f5dc'},
      {name:'CORAL', val:'#ff7f50'},
      {name:'SALMON', val:'#fa8072'},
      {name:'KHAKI', val:'#f0e68c'},
      {name:'AQUA', val:'#00ffff'},
      {name:'FUCHSIA', val:'#ff00ff'},
      {name:'MINT', val:'#98ff98'},
      {name:'LAVENDER', val:'#e6e6fa'}
    ];

    // DOM refs
    const optionsEl = document.getElementById('options');
    const wordEl = document.getElementById('word');
    const statusEl = document.getElementById('status');
    const fillEl = document.getElementById('fill');
    const overlay = document.getElementById('overlay');
    const num = document.getElementById('num');
    const sayBtn = document.getElementById('sayBtn');
    const soundBtn = document.getElementById('soundBtn');
    const resetBtn = document.getElementById('resetBtn');

    // State
    let target = null, score = 0, total = 0, busy = false;

    // Utils
    const randInt = n => Math.floor(Math.random() * n);
    const pick = () => COLORS[randInt(COLORS.length)];
    function uniquePicks(count, excludeName){
      const set = new Set(excludeName ? [excludeName] : []);
      const arr = [];
      while(arr.length < count){
        const c = pick();
        if(!set.has(c.name)){
          set.add(c.name); arr.push(c);
        }
      }
      return arr;
    }

    function setStatus(type){
      if(type===true){ statusEl.textContent = "Great job! ⭐"; statusEl.style.color = 'var(--good)'; }
      else if(type===false){ statusEl.textContent = "Try again! ⤴"; statusEl.style.color = 'var(--bad)'; }
      else { statusEl.textContent = ""; }
    }

    function announce(){
      if(!target) return;
      speak('Find the color ' + target.name);
    }

    function createBalloon(color, onTap){
      const btn = document.createElement('button');
      btn.className = 'balloon';
      btn.style.background = color.val;
      btn.setAttribute('aria-label', color.name + ' balloon');
      btn.style.color = '#fff';
      btn.style.borderColor = 'rgba(255,255,255,.6)';
      btn.tabIndex = 0;

      const shine = document.createElement('div');
      shine.className = 'shine';
      btn.appendChild(shine);

      // Events
      const pointerEv = ('ontouchstart' in window) ? 'touchstart' : 'pointerdown';
      btn.addEventListener(pointerEv, e => {
        e.preventDefault();
        onTap();
      }, {passive:false});

      // Keyboard support (for completeness)
      btn.addEventListener('keydown', e=>{
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          onTap();
        }
      });

      return btn;
    }

    function addBurst(parent){
      const b = document.createElement('div'); b.className = 'burst';
      const count = 12;
      for(let i=0;i<count;i++){
        const p = document.createElement('i');
        p.style.setProperty('--a', (360/count)*i + 'deg');
        // rainbow-ish particles
        p.style.background = `hsl(${Math.floor(Math.random()*360)}, 85%, 65%)`;
        b.appendChild(p);
      }
      parent.appendChild(b);
      setTimeout(()=> b.remove(), 520);
    }

    function updateProgress(){
      const pct = Math.round((score / Math.max(1, total)) * 100);
      fillEl.style.width = pct + '%';
    }

    function buildRound(){
      optionsEl.innerHTML = '';
      setStatus('');
      const correct = pick();
      target = correct;
      wordEl.textContent = correct.name;

      announce();

      const picks = [correct, ...uniquePicks(2, correct.name)].sort(()=>Math.random()-0.5);
      picks.forEach(c=>{
        const item = createBalloon(c, ()=> onPick(c, item));
        optionsEl.appendChild(item);
      });
    }

    function onPick(choice, el){
      if(busy) return;
      ensureAudio();
      total++;
      if(choice.name === target.name){
        score++;
        setStatus(true);
        try { window.navigator.vibrate && window.navigator.vibrate(40); } catch(_){}
        el.classList.remove('wrong'); el.classList.add('pop');
        addBurst(el);
        successSound();
        updateProgress();
        startCountdownThen(buildRound, 2);
      } else {
        setStatus(false);
        try { window.navigator.vibrate && window.navigator.vibrate([25, 40, 25]); } catch(_){}
        el.classList.remove('pop'); el.classList.add('wrong');
        errorSound();
        speak('Try again');
        updateProgress(); // keep ratio consistent with attempts
        setTimeout(()=> el.classList.remove('wrong'), 350);
      }
    }

    function startCountdownThen(cb, secs=2){
      busy = true;
      overlay.style.display='flex';
      overlay.setAttribute('aria-hidden', 'false');
      let k = secs;
      num.textContent = k;
      const tick = () => {
        k--;
        if(k<=0){
          overlay.style.display='none';
          overlay.setAttribute('aria-hidden', 'true');
          busy = false;
          cb();
          return;
        }
        num.textContent = k;
        setTimeout(tick, 1000);
      };
      setTimeout(tick, 1000);
    }

    function resetGame(){
      score = 0; total = 0; fillEl.style.width = '0%';
      setStatus('');
      buildRound();
    }

    // Wire controls
    sayBtn.addEventListener('click', ()=>{ ensureAudio(); announce(); });
    soundBtn.addEventListener('click', ()=>{
      SETTINGS.sound = !SETTINGS.sound;
      soundBtn.setAttribute('aria-pressed', SETTINGS.sound? 'true':'false');
      soundBtn.setAttribute('aria-label', SETTINGS.sound? 'Sound on':'Sound off');
      soundBtn.style.opacity = SETTINGS.sound? '1' : '.6';
      if(SETTINGS.sound){
        ensureAudio();
        tone(880, 120, 'sine', 0.05);
      }else{
        try{ window.speechSynthesis && window.speechSynthesis.cancel(); }catch(_){}
      }
    });
    resetBtn.addEventListener('click', ()=>{
      ensureAudio();
      tone(660, 100, 'sine', 0.05);
      resetGame();
    });

    // Start
    resetGame();
  </script>
</body>
</html>